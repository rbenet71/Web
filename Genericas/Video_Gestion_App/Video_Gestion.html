<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Video Gestión - Herramientas FFMPEG</title>
    
    <!-- PWA -->
    <link rel="manifest" href="Video_Gestion_manifest.json">
    <meta name="theme-color" content="#2c3e50">
    
    <!-- Iconos -->
    <link rel="icon" type="image/png" href="assets/Video_Gestion_192x192.png">
    <link rel="apple-touch-icon" href="assets/Video_Gestion_192x192.png">
    
    <!-- Estilos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="Video_Gestion_styles.css">
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script.src = '/libs/ffmpeg/ffmpeg.min.js'></script>
</head>
<body>
    <!-- =========================================== -->
    <!-- HEADER -->
    <!-- =========================================== -->
    <header class="app-header">
        <div class="container">
            <div class="header-content">
                <div class="app-title">
                    <img src="assets/Video_Gestion_192x192.png" 
                         alt="Logo Video Gestión" 
                         class="app-logo">
                    <h1 id="app-title-text">Video Gestión FFMPEG</h1>
                </div>
                <div class="header-controls">
                    <div class="language-selector">
                        <div class="languages-label" id="languages-label">Idioma</div>
                        <img src="https://flagcdn.com/w40/es.png" class="flag active" id="flag-es" data-lang="es">
                        <img src="https://flagcdn.com/w40/gb.png" class="flag" id="flag-en" data-lang="en">
                        <img src="https://flagcdn.com/w40/fr.png" class="flag" id="flag-fr" data-lang="fr">
                        <div class="flag flag-catalunya" id="flag-ca" data-lang="ca"></div>
                        <i class="fas fa-question-circle help-icon" id="help-icon-header" title="Ayuda"></i>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- =========================================== -->
    <!-- MENÚ PRINCIPAL -->
    <!-- =========================================== -->
    <main class="main-content">
        <div class="container">
            <div class="menu-grid">
                <!-- Opción 1: Reducir tamaño -->
                <div class="menu-card" id="reduce-size-card">
                    <div class="menu-icon">
                        <i class="fas fa-compress-alt"></i>
                    </div>
                    <h3 id="reduce-size-title">Reducir Tamaño Video</h3>
                    <p id="reduce-size-desc">Optimiza videos para diferentes dispositivos</p>
                </div>

                <!-- Opción 2: Cortar video -->
                <div class="menu-card" id="cut-video-card">
                    <div class="menu-icon">
                        <i class="fas fa-cut"></i>
                    </div>
                    <h3 id="cut-video-title">Cortar Video</h3>
                    <p id="cut-video-desc">Extrae fragmentos específicos del video</p>
                </div>

                <!-- Opción 3: Convertir formato -->
                <div class="menu-card" id="convert-format-card">
                    <div class="menu-icon">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <h3 id="convert-format-title">Convertir Formato</h3>
                    <p id="convert-format-desc">Cambia entre MP4, MOV, AVI</p>
                </div>

                <!-- Opción 4: Revertir video -->
                <div class="menu-card" id="reverse-video-card">
                    <div class="menu-icon">
                        <i class="fas fa-backward"></i>
                    </div>
                    <h3 id="reverse-video-title">Revertir Video</h3>
                    <p id="reverse-video-desc">Invierte el orden de los frames</p>
                </div>

                <!-- Opción 5: Convertir a JPG -->
                <div class="menu-card" id="to-jpg-card">
                    <div class="menu-icon">
                        <i class="fas fa-camera"></i>
                    </div>
                    <h3 id="to-jpg-title">Convertir a JPG</h3>
                    <p id="to-jpg-desc">Extrae fotos con datos GPS</p>
                </div>

                <!-- Opción 6: Unir videos -->
                <div class="menu-card" id="join-videos-card">
                    <div class="menu-icon">
                        <i class="fas fa-link"></i>
                    </div>
                    <h3 id="join-videos-title">Unir Videos</h3>
                    <p id="join-videos-desc">Combina múltiples videos en uno</p>
                </div>
            </div>
        </div>
    </main>

    <!-- =========================================== -->
    <!-- MODALES PARA CADA FUNCIÓN -->
    <!-- =========================================== -->
    
    <!-- Modal: Reducir Tamaño -->
    <div class="modal" id="reduce-size-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="reduce-size-modal-title">Reducir Tamaño de Video</h3>
                <button class="modal-close" id="reduce-size-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="reduce-size-form">
                    <div class="form-group">
                        <label for="quality-select" id="quality-label">Calidad de destino:</label>
                        <select id="quality-select" class="form-control">
                            <option value="pc" id="quality-pc">PC (Alta calidad)</option>
                            <option value="tablet" id="quality-tablet">Tablet (Calidad media)</option>
                            <option value="mobile" id="quality-mobile">Móvil (Calidad baja)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="reduce-file-input" id="reduce-file-label">Archivo a convertir:</label>
                        <div class="file-input-group">
                            <input type="text" id="reduce-file-path" class="form-control" readonly>
                            <button type="button" class="btn btn-secondary" id="reduce-browse-btn">
                                <i class="fas fa-folder-open"></i> <span id="browse-text">Examinar</span>
                            </button>
                        </div>
                        <input type="file" id="reduce-file-input" accept="video/*" style="display: none;">
                    </div>
                    
                    <div class="form-group">
                        <label for="reduce-dest-folder" id="reduce-dest-label">Carpeta destino:</label>
                        <div class="file-input-group">
                            <input type="text" id="reduce-dest-folder" class="form-control">
                            <button type="button" class="btn btn-secondary" id="reduce-dest-browse-btn">
                                <i class="fas fa-folder"></i> <span id="folder-text">Carpeta</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="progress-container" style="display: none;" id="reduce-progress-container">
                        <div class="progress-label" id="reduce-progress-label">Procesando...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="reduce-progress-fill"></div>
                        </div>
                        <div class="progress-text" id="reduce-progress-text">0%</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" id="reduce-convert-btn">
                    <i class="fas fa-play"></i> <span id="convert-btn-text">Convertir</span>
                </button>
                <button class="btn btn-danger" id="reduce-cancel-btn">
                    <i class="fas fa-times"></i> <span id="cancel-btn-text">Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Cortar Video -->
    <div class="modal" id="cut-video-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="cut-video-modal-title">Cortar Video</h3>
                <button class="modal-close" id="cut-video-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="cut-video-form">
                    <div class="form-group">
                        <label for="cut-file-input" id="cut-file-label">Video a cortar:</label>
                        <div class="file-input-group">
                            <input type="text" id="cut-file-path" class="form-control" readonly>
                            <button type="button" class="btn btn-secondary" id="cut-browse-btn">
                                <i class="fas fa-folder-open"></i> <span id="cut-browse-text">Examinar</span>
                            </button>
                        </div>
                        <input type="file" id="cut-file-input" accept="video/*" style="display: none;">
                        <div class="video-info" id="cut-video-info"></div>
                    </div>
                    
                    <div class="time-inputs">
                        <div class="form-group">
                            <label for="cut-start-time" id="cut-start-label">Tiempo Inicio (HH:MM:SS):</label>
                            <input type="text" id="cut-start-time" class="form-control time-input" value="00:00:00">
                        </div>
                        <div class="form-group">
                            <label for="cut-end-time" id="cut-end-label">Tiempo Final (HH:MM:SS):</label>
                            <input type="text" id="cut-end-time" class="form-control time-input" value="00:00:00">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cut-dest-folder" id="cut-dest-label">Carpeta destino:</label>
                        <div class="file-input-group">
                            <input type="text" id="cut-dest-folder" class="form-control">
                            <button type="button" class="btn btn-secondary" id="cut-dest-browse-btn">
                                <i class="fas fa-folder"></i> <span id="cut-folder-text">Carpeta</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="progress-container" style="display: none;" id="cut-progress-container">
                        <div class="progress-label" id="cut-progress-label">Cortando video...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="cut-progress-fill"></div>
                        </div>
                        <div class="progress-text" id="cut-progress-text">0%</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" id="cut-convert-btn">
                    <i class="fas fa-cut"></i> <span id="cut-btn-text">Cortar</span>
                </button>
                <button class="btn btn-danger" id="cut-cancel-btn">
                    <i class="fas fa-times"></i> <span id="cut-cancel-text">Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Convertir Formato -->
    <div class="modal" id="convert-format-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="convert-format-modal-title">Convertir Formato de Video</h3>
                <button class="modal-close" id="convert-format-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="convert-format-form">
                    <div class="form-group">
                        <label for="format-select" id="format-label">Formato destino:</label>
                        <select id="format-select" class="form-control">
                            <option value="mp4" id="format-mp4">MP4</option>
                            <option value="mov" id="format-mov">MOV</option>
                            <option value="avi" id="format-avi">AVI</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="convert-file-input" id="convert-file-label">Archivo a convertir:</label>
                        <div class="file-input-group">
                            <input type="text" id="convert-file-path" class="form-control" readonly>
                            <button type="button" class="btn btn-secondary" id="convert-browse-btn">
                                <i class="fas fa-folder-open"></i> <span id="convert-browse-text">Examinar</span>
                            </button>
                        </div>
                        <input type="file" id="convert-file-input" accept="video/*" style="display: none;">
                    </div>
                    
                    <div class="form-group">
                        <label for="convert-dest-folder" id="convert-dest-label">Carpeta destino:</label>
                        <div class="file-input-group">
                            <input type="text" id="convert-dest-folder" class="form-control">
                            <button type="button" class="btn btn-secondary" id="convert-dest-browse-btn">
                                <i class="fas fa-folder"></i> <span id="convert-folder-text">Carpeta</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="progress-container" style="display: none;" id="convert-progress-container">
                        <div class="progress-label" id="convert-progress-label">Convirtiendo formato...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="convert-progress-fill"></div>
                        </div>
                        <div class="progress-text" id="convert-progress-text">0%</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" id="format-convert-btn">
                    <i class="fas fa-exchange-alt"></i> <span id="format-convert-text">Convertir</span>
                </button>
                <button class="btn btn-danger" id="format-cancel-btn">
                    <i class="fas fa-times"></i> <span id="format-cancel-text">Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Revertir Video -->
    <div class="modal" id="reverse-video-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="reverse-video-modal-title">Revertir Video</h3>
                <button class="modal-close" id="reverse-video-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="reverse-video-form">
                    <div class="form-group">
                        <label for="reverse-file-input" id="reverse-file-label">Video a revertir:</label>
                        <div class="file-input-group">
                            <input type="text" id="reverse-file-path" class="form-control" readonly>
                            <button type="button" class="btn btn-secondary" id="reverse-browse-btn">
                                <i class="fas fa-folder-open"></i> <span id="reverse-browse-text">Examinar</span>
                            </button>
                        </div>
                        <input type="file" id="reverse-file-input" accept="video/*" style="display: none;">
                    </div>
                    
                    <div class="form-group">
                        <label for="reverse-dest-folder" id="reverse-dest-label">Carpeta destino:</label>
                        <div class="file-input-group">
                            <input type="text" id="reverse-dest-folder" class="form-control">
                            <button type="button" class="btn btn-secondary" id="reverse-dest-browse-btn">
                                <i class="fas fa-folder"></i> <span id="reverse-folder-text">Carpeta</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="progress-container" style="display: none;" id="reverse-progress-container">
                        <div class="progress-label" id="reverse-progress-label">Revirtiendo video...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="reverse-progress-fill"></div>
                        </div>
                        <div class="progress-text" id="reverse-progress-text">0%</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" id="reverse-convert-btn">
                    <i class="fas fa-backward"></i> <span id="reverse-convert-text">Revertir</span>
                </button>
                <button class="btn btn-danger" id="reverse-cancel-btn">
                    <i class="fas fa-times"></i> <span id="reverse-cancel-text">Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Convertir a JPG -->
    <div class="modal" id="to-jpg-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="to-jpg-modal-title">Convertir Video a JPG con GPS</h3>
                <button class="modal-close" id="to-jpg-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="to-jpg-form">
                    <div class="form-group">
                        <label for="jpg-file-input" id="jpg-file-label">Video origen:</label>
                        <div class="file-input-group">
                            <input type="text" id="jpg-file-path" class="form-control" readonly>
                            <button type="button" class="btn btn-secondary" id="jpg-browse-btn">
                                <i class="fas fa-folder-open"></i> <span id="jpg-browse-text">Examinar</span>
                            </button>
                        </div>
                        <input type="file" id="jpg-file-input" accept="video/*" style="display: none;">
                        <div class="gps-info" id="gps-info">
                            <i class="fas fa-info-circle"></i> <span id="gps-status">Cargando información GPS...</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="jpg-size-select" id="jpg-size-label">Tamaño JPG:</label>
                        <select id="jpg-size-select" class="form-control">
                            <option value="4k" id="size-4k">4K (3840x2160)</option>
                            <option value="1024" id="size-1024">1024px (ancho)</option>
                            <option value="512" id="size-512">512px (ancho)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="jpg-interval" id="jpg-interval-label">JPG cada (segundos):</label>
                        <input type="number" id="jpg-interval" class="form-control" min="1" value="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="jpg-dest-folder" id="jpg-dest-label">Carpeta destino:</label>
                        <div class="file-input-group">
                            <input type="text" id="jpg-dest-folder" class="form-control">
                            <button type="button" class="btn btn-secondary" id="jpg-dest-browse-btn">
                                <i class="fas fa-folder"></i> <span id="jpg-folder-text">Carpeta</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="progress-container" style="display: none;" id="jpg-progress-container">
                        <div class="progress-label" id="jpg-progress-label">Extrayendo fotogramas...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="jpg-progress-fill"></div>
                        </div>
                        <div class="progress-text" id="jpg-progress-text">0 fotogramas procesados</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" id="jpg-convert-btn">
                    <i class="fas fa-camera"></i> <span id="jpg-convert-text">Extraer JPG</span>
                </button>
                <button class="btn btn-danger" id="jpg-cancel-btn">
                    <i class="fas fa-times"></i> <span id="jpg-cancel-text">Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Unir Videos -->
    <div class="modal" id="join-videos-modal">
        <div class="modal-content wide-modal">
            <div class="modal-header">
                <h3 id="join-videos-modal-title">Unir Videos</h3>
                <button class="modal-close" id="join-videos-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="session-manager">
                    <div class="form-group">
                        <label for="session-select" id="session-label">Sesión:</label>
                        <div class="session-controls">
                            <select id="session-select" class="form-control">
                                <option value="" id="new-session-option">-- Nueva sesión --</option>
                            </select>
                            <button class="btn btn-primary" id="new-session-btn">
                                <i class="fas fa-plus"></i> <span id="new-session-text">Nueva</span>
                            </button>
                            <button class="btn btn-danger" id="delete-session-btn">
                                <i class="fas fa-trash"></i> <span id="delete-session-text">Eliminar</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="output-file" id="output-file-label">Archivo de salida:</label>
                        <div class="file-input-group">
                            <input type="text" id="output-file" class="form-control">
                            <button type="button" class="btn btn-secondary" id="output-browse-btn">
                                <i class="fas fa-folder-open"></i> <span id="output-browse-text">Examinar</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="videos-table-container">
                    <div class="table-controls">
                        <button class="btn btn-success" id="add-file-btn">
                            <i class="fas fa-plus"></i> <span id="add-file-text">Añadir archivo</span>
                        </button>
                        <button class="btn btn-info" id="add-folder-btn">
                            <i class="fas fa-folder-plus"></i> <span id="add-folder-text">Añadir carpeta</span>
                        </button>
                        <button class="btn btn-warning" id="move-up-btn">
                            <i class="fas fa-arrow-up"></i> <span id="move-up-text">Subir</span>
                        </button>
                        <button class="btn btn-warning" id="move-down-btn">
                            <i class="fas fa-arrow-down"></i> <span id="move-down-text">Bajar</span>
                        </button>
                        <button class="btn btn-danger" id="remove-file-btn">
                            <i class="fas fa-trash"></i> <span id="remove-file-text">Eliminar</span>
                        </button>
                        <button class="btn btn-secondary" id="clear-table-btn">
                            <i class="fas fa-broom"></i> <span id="clear-table-text">Vaciar tabla</span>
                        </button>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="videos-table" id="videos-table">
                            <thead>
                                <tr>
                                    <th><input type="checkbox" id="select-all"></th>
                                    <th id="order-header">Orden</th>
                                    <th id="name-header">Nombre Archivo</th>
                                    <th id="date-header">Fecha</th>
                                    <th id="size-header">Tamaño</th>
                                    <th id="duration-header">Duración</th>
                                    <th id="start-header">Tiempo Inicio</th>
                                    <th id="end-header">Tiempo Final</th>
                                    <th id="path-header">Ruta completa</th>
                                    <th id="actions-header">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="videos-table-body">
                                <!-- Las filas se agregarán dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="backup-controls">
                        <button class="btn btn-primary" id="backup-btn">
                            <i class="fas fa-save"></i> <span id="backup-text">Copia de seguridad</span>
                        </button>
                        <button class="btn btn-secondary" id="restore-backup-btn">
                            <i class="fas fa-upload"></i> <span id="restore-text">Restaurar copia</span>
                        </button>
                        <button class="btn btn-info" id="add-multiple-cuts-btn">
                            <i class="fas fa-cut"></i> <span id="multiple-cuts-text">Añadir varios cortes</span>
                        </button>
                        <button class="btn btn-success" id="join-videos-btn">
                            <i class="fas fa-link"></i> <span id="join-btn-text">Unir videos</span>
                        </button>
                    </div>
                </div>
                
                <div class="progress-container" style="display: none;" id="join-progress-container">
                    <div class="progress-label" id="join-progress-label">Uniendo videos...</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="join-progress-fill"></div>
                    </div>
                    <div class="progress-text" id="join-progress-text">0%</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="join-cancel-btn">
                    <i class="fas fa-times"></i> <span id="join-cancel-text">Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de múltiples cortes -->
    <div class="modal" id="multiple-cuts-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="multiple-cuts-modal-title">Añadir Múltiples Cortes</h3>
                <button class="modal-close" id="multiple-cuts-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="cuts-container" id="cuts-container">
                    <!-- Los cortes se añadirán aquí -->
                </div>
                <button class="btn btn-primary" id="add-cut-btn">
                    <i class="fas fa-plus"></i> <span id="add-cut-text">Añadir corte</span>
                </button>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" id="save-cuts-btn">
                    <i class="fas fa-save"></i> <span id="save-cuts-text">Guardar cortes</span>
                </button>
                <button class="btn btn-danger" id="cancel-cuts-btn">
                    <i class="fas fa-times"></i> <span id="cancel-cuts-text">Cancelar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de reproducción -->
    <div class="modal" id="playback-modal">
        <div class="modal-content wide-modal">
            <div class="modal-header">
                <h3 id="playback-modal-title">Reproducir Video</h3>
                <button class="modal-close" id="playback-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="video-player-container">
                    <video id="video-player" controls style="width: 100%;">
                        <source src="" type="video/mp4">
                        Tu navegador no soporta la reproducción de video.
                    </video>
                </div>
                <div class="playback-controls">
                    <div class="speed-controls">
                        <span id="speed-label">Velocidad:</span>
                        <button class="btn btn-sm btn-outline speed-btn" data-speed="0.25">0.25x</button>
                        <button class="btn btn-sm btn-outline speed-btn" data-speed="0.5">0.5x</button>
                        <button class="btn btn-sm btn-primary speed-btn" data-speed="1">1x</button>
                        <button class="btn btn-sm btn-outline speed-btn" data-speed="2">2x</button>
                        <button class="btn btn-sm btn-outline speed-btn" data-speed="5">5x</button>
                        <button class="btn btn-sm btn-outline speed-btn" data-speed="8">8x</button>
                        <button class="btn btn-sm btn-outline speed-btn" data-speed="16">16x</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="playback-cancel-btn">
                    <i class="fas fa-times"></i> <span id="playback-cancel-text">Cerrar</span>
                </button>
            </div>
        </div>
    </div>

    <!-- =========================================== -->
    <!-- FOOTER -->
    <!-- =========================================== -->
    <footer class="app-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <button class="footer-btn" id="footer-help-btn">
                        <i class="fas fa-question-circle"></i>
                        <span id="help-text">Ayuda</span>
                    </button>
                    <button class="footer-btn" id="suggestions-btn">
                        <i class="fas fa-lightbulb"></i>
                        <span id="suggestions-text">Sugerencias</span>
                    </button>
                    <button class="footer-btn" id="install-btn">
                        <i class="fas fa-download"></i>
                        <span id="install-text">Instalar App</span>
                    </button>
                </div>
                <div class="copyright" id="copyright-text">
                    2025 © Copyright 
                    <a href="https://rbenet71.github.io/Web/" target="_blank" id="copyright-link">
                        Roberto Benet - rbenet71@gmail.com - V_18_12_2025
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- =========================================== -->
    <!-- MODALES GENERALES -->
    <!-- =========================================== -->
    
    <!-- Modal de ayuda (COMPLETO Y MULTILINGÜE) -->
    <div class="modal" id="help-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="help-modal-title">Ayuda de Video Gestión</h3>
                <button class="modal-close" id="help-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="help-modal-text1">Video Gestión es una aplicación PWA para procesar videos usando FFMPEG directamente en tu navegador.</p>
                
                <h4 id="help-modal-subtitle1">Funciones disponibles:</h4>
                <ul id="help-modal-list">
                    <li><strong id="help-reduce-title">Reducir tamaño:</strong> <span id="help-reduce-desc">Optimiza videos para PC, Tablet o Móvil</span></li>
                    <li><strong id="help-cut-title">Cortar video:</strong> <span id="help-cut-desc">Extrae fragmentos específicos entre tiempos definidos</span></li>
                    <li><strong id="help-convert-title">Convertir formato:</strong> <span id="help-convert-desc">Cambia entre MP4, MOV, AVI preservando calidad</span></li>
                    <li><strong id="help-reverse-title">Revertir video:</strong> <span id="help-reverse-desc">Invierte el orden de los fotogramas</span></li>
                    <li><strong id="help-jpg-title">Convertir a JPG:</strong> <span id="help-jpg-desc">Extrae fotos con datos GPS si están disponibles</span></li>
                    <li><strong id="help-join-title">Unir videos:</strong> <span id="help-join-desc">Combina múltiples videos en uno con cortes personalizados</span></li>
                </ul>
                
                <h4 id="help-modal-subtitle2">Requisitos:</h4>
                <ul id="help-requirements-list">
                    <li id="help-req1">Navegador moderno (Chrome 80+, Firefox 75+, Edge 80+)</li>
                    <li id="help-req2">Soporte para WebAssembly</li>
                    <li id="help-req3">Permisos para acceder al sistema de archivos</li>
                    <li id="help-req4">Espacio suficiente en disco para archivos temporales</li>
                </ul>
                
                <h4 id="help-modal-subtitle3">Notas importantes:</h4>
                <ul id="help-notes-list">
                    <li id="help-note1">Los procesamientos se realizan en el navegador (puede ser lento para videos grandes)</li>
                    <li id="help-note2">Se preservan los metadatos GPS cuando es posible</li>
                    <li id="help-note3">La aplicación funciona offline una vez instalada</li>
                    <li id="help-note4">Los archivos procesados se descargan automáticamente</li>
                    <li id="help-note5">Las sesiones de unión se guardan automáticamente</li>
                </ul>
                
                <h4 id="help-modal-subtitle4">Cómo usar cada función:</h4>
                
                <div class="help-section">
                    <h5 id="help-section-reduce">1. Reducir Tamaño:</h5>
                    <ul>
                        <li id="help-reduce-step1">Selecciona calidad: PC (alta), Tablet (media) o Móvil (baja)</li>
                        <li id="help-reduce-step2">Elige el archivo de video</li>
                        <li id="help-reduce-step3">La carpeta destino se autocompleta</li>
                        <li id="help-reduce-step4">Haz clic en "Convertir"</li>
                        <li id="help-reduce-step5">El archivo se guardará con sufijo _PC, _Tablet o _Movil</li>
                    </ul>
                </div>
                
                <div class="help-section">
                    <h5 id="help-section-cut">2. Cortar Video:</h5>
                    <ul>
                        <li id="help-cut-step1">Selecciona el video a cortar</li>
                        <li id="help-cut-step2">La duración total se mostrará automáticamente</li>
                        <li id="help-cut-step3">Define tiempos de inicio y final (formato HH:MM:SS)</li>
                        <li id="help-cut-step4">Haz clic en "Cortar"</li>
                        <li id="help-cut-step5">El archivo se guardará con sufijo _Cortado</li>
                    </ul>
                </div>
                
                <div class="help-section">
                    <h5 id="help-section-convert">3. Convertir Formato:</h5>
                    <ul>
                        <li id="help-convert-step1">Selecciona formato destino: MP4, MOV o AVI</li>
                        <li id="help-convert-step2">Elige el archivo a convertir</li>
                        <li id="help-convert-step3">Haz clic en "Convertir"</li>
                        <li id="help-convert-step4">El archivo se guardará con sufijo _Convertido</li>
                    </ul>
                </div>
                
                <div class="help-section">
                    <h5 id="help-section-reverse">4. Revertir Video:</h5>
                    <ul>
                        <li id="help-reverse-step1">Selecciona el video a revertir</li>
                        <li id="help-reverse-step2">Haz clic en "Revertir"</li>
                        <li id="help-reverse-step3">El archivo se guardará con sufijo _Reverse</li>
                    </ul>
                </div>
                
                <div class="help-section">
                    <h5 id="help-section-jpg">5. Convertir a JPG:</h5>
                    <ul>
                        <li id="help-jpg-step1">Selecciona video con datos GPS (opcional)</li>
                        <li id="help-jpg-step2">Elige tamaño: 4K, 1024px o 512px</li>
                        <li id="help-jpg-step3">Define intervalo entre fotos (segundos)</li>
                        <li id="help-jpg-step4">Haz clic en "Extraer JPG"</li>
                        <li id="help-jpg-step5">Las fotos se guardarán con nombres HHMMSSS.jpg</li>
                    </ul>
                </div>
                
                <div class="help-section">
                    <h5 id="help-section-join">6. Unir Videos:</h5>
                    <ul>
                        <li id="help-join-step1">Crea o carga una sesión</li>
                        <li id="help-join-step2">Añade archivos o carpetas completas</li>
                        <li id="help-join-step3">Ordena los videos arrastrando o usando botones</li>
                        <li id="help-join-step4">Define cortes específicos para cada video</li>
                        <li id="help-join-step5">Guarda copia de seguridad (recomendado)</li>
                        <li id="help-join-step6">Haz clic en "Unir videos"</li>
                    </ul>
                </div>
                
                <h4 id="help-modal-subtitle5">Indicadores visuales:</h4>
                <ul id="help-indicators-list">
                    <li id="help-indicator1"><strong>Barra de progreso:</strong> Muestra el avance del procesamiento</li>
                    <li id="help-indicator2"><strong>Info GPS:</strong> Indica si el video tiene datos de ubicación</li>
                    <li id="help-indicator3"><strong>Mensajes flotantes:</strong> Notificaciones de éxito/error</li>
                </ul>
                
                <h4 id="help-modal-subtitle6">Consejos de rendimiento:</h4>
                <ul id="help-tips-list">
                    <li id="help-tip1">Para videos grandes (>500MB), procesa en segmentos</li>
                    <li id="help-tip2">Cierra otras pestañas del navegador</li>
                    <li id="help-tip3">Usa calidad más baja para procesamiento más rápido</li>
                    <li id="help-tip4">Guarda sesiones de trabajo para recuperarlas luego</li>
                </ul>
                
                <h4 id="help-modal-subtitle7">Solución de problemas:</h4>
                <ul id="help-troubleshooting-list">
                    <li id="help-trouble1"><strong>FFMPEG no carga:</strong> Verifica conexión a internet y recarga</li>
                    <li id="help-trouble2"><strong>Procesamiento lento:</strong> Reduce calidad o tamaño del video</li>
                    <li id="help-trouble3"><strong>Error al guardar:</strong> Verifica permisos del navegador</li>
                    <li id="help-trouble4"><strong>Sin datos GPS:</strong> El video puede no contener información de ubicación</li>
                </ul>
                
                <p id="help-modal-text2" style="margin-top: 20px; font-style: italic;">
                    La aplicación guarda automáticamente tus preferencias y sesiones. Puedes usar la función "Copia de seguridad" para exportar tus datos.
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="help-modal-ok">Entendido</button>
            </div>
        </div>
    </div>

    <!-- Modal de sugerencias -->
    <div class="modal" id="suggestions-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="suggestions-modal-title">Enviar sugerencias</h3>
                <button class="modal-close" id="suggestions-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="suggestion-form">
                    <div class="form-group">
                        <label for="suggestion-email" id="suggestion-email-label">Email (opcional):</label>
                        <input type="email" id="suggestion-email" class="form-control" placeholder="tu@email.com">
                    </div>
                    <div class="form-group">
                        <label for="suggestion-text" id="suggestion-text-label">Sugerencias:</label>
                        <textarea id="suggestion-text" class="form-control" rows="5" placeholder="Tus ideas para mejorar la aplicación..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="send-suggestion-btn">Enviar</button>
                <button class="btn btn-danger" id="cancel-suggestion-btn">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Mensajes flotantes -->
    <div id="message" class="message"></div>

    <!-- =========================================== -->
    <!-- SCRIPTS -->
    <!-- =========================================== -->
    <script src="Video_Gestion_translaciones.js"></script>
    <script src="Video_Gestion_almacenamiento.js"></script>
    <script src="Video_Gestion_ui.js"></script>
    <script src="Video_Gestion_procesadorVideo.js"></script>
    <script src="Video_Gestion_app.js"></script>
    
    <!-- Registrar Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('Video_Gestion_serviceWorker.js')
                .then(reg => console.log('Service Worker registrado', reg))
                .catch(err => console.log('Error registrando Service Worker', err));
        }
        
        // Detectar si es PWA instalada
        window.addEventListener('appinstalled', () => {
            document.getElementById('install-btn').style.display = 'none';
        });
        
        // Mostrar botón de instalación si aplica
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            window.deferredPrompt = e;
            document.getElementById('install-btn').style.display = 'inline-block';
        });
    </script>
</body>
</html>